<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="/search.css">
</head>
<body>
  <%- include('header.ejs') %>


  <main class="container">
    <section class="row justify-content-center">
      
      <div class="select col-3">
        <div class="sel-social">
          <div class="title d-flex">
            <div class="square" style="background-color: rgb(234, 99, 99);"></div>
            <h4>소셜</h4>
          </div>

          <ul class="filterOption">

            <li class="filterBtn">
              <div class="filterBtn-click d-flex">
                <img src="/image/plus.png" alt="+">
                <p>내가좋아요한</p>
              </div>
            </li>

            <li class="filterBtn">
              <div class="filterBtn-click d-flex">
                <img src="/image/plus.png" alt="+">
                <p>나의팔로우추천</p>
              </div>
            </li>

            <li class="filterBtn">
              <div class="filterBtn-click d-flex">
                <img src="/image/plus.png" alt="+">
                <p>다코미식가추천
                </p>
              </div>
            </li>

          </ul>
          <div class="bk"><hr></div>
        </div>

        <div class="sel-user-age">
          <div class="title d-flex">
            <div class="square" style="background-color: rgb(255, 125, 60);"></div>
            <h4>이용자층</h4>
          </div>

          <ul class="peopleGroup row">
            <div class="form-check col-6">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  20대
                </label>
              </div>
            <div class="form-check col-6">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  30대
                </label>
              </div>
            <div class="form-check col-6">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  40대
                </label>
              </div>
            <div class="form-check col-6">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  50대
                </label>
              </div>
            <div class="form-check col-6">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  60대 이상
                </label>
              </div>
            
            <li class="filterBtn col-6"></li>
          </ul>

          <div class="bk"><hr></div>
          <ul class="gender row">
            <li class="col">
              <img src="/image/circle.png" class="click" alt="">
              <label for="male">남자</label>
            </li>
            <li class="col">
              <img src="/image/circle.png" class="click" alt="">
              <label for="female">여자</label>
            </li>
          </ul>
          <div class="bk"><hr></div>         
        </div>
        
        <div class="sel-category">
          <div class="title d-flex">
            <div class="square" style="background-color: rgb(251, 201, 68);"></div>
            <h4>카테고리</h4>
          </div>
          <ul class="CategoryGroup row">
            <li class="filterBtn col-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  한식
                </label>
              </div>
            </li>
            <li class="filterBtn col-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  일식
                </label>
              </div>
            </li>
            <li class="filterBtn col-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  중식
                </label>
              </div>
            </li>
            <li class="filterBtn col-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  아시안
                </label>
              </div>
            </li>
            <li class="filterBtn col-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                <label class="form-check-label" for="flexCheckDefault">
                  디저트
                </label>
              </div>
            </li>
          </ul>
            
          <div class="dk"><hr></div>
          <div class="sel-location">
            <div class="title d-flex">
              <div class="square" style="background-color: rgb(67, 163, 147);"></div>
              <h4>지역</h4>
            </div>
            <button class="question"><span>광역시도</span></button>
            <div class="answer">
              <ul class="city_list">
                <li>서울</li>
                <li>경기</li>
                <li>인천</li>
                <li>강원</li>
                <li>세종</li>
                <li>부산</li>
                <li>경남</li>
                <li>경북</li>
                <li>광주</li>
                <li>전주</li>
                <li>목포</li>
                <li>전라</li>
              </ul>
            </div>
          </div>
          <div class="bk"><hr></div>
        </div>
      </div>


      <div class="food-shop col-9">
        <div class="order-wrap row">
          <div class="l-btn d-flex" >
            <div class="range">
              <span><img src="/image/tab.png" alt="정렬">정렬</span>
            </div>
            <div class="order">
              <button class="grade"><span>평점순</span></button>
              <button class="review"><span>리뷰많은순</span></button>
              <button class="like"><span>좋아요많은순</span></button>
              <button class="load"><span>조회순</span></button>
              <button class="yeon"><span>연관순</span></button>
            </div>
          </div>
        </div>
          <div class="r-btn col" id="map">
            <%- include('maps.ejs') %>
          </div>
        <div class="select-shop">
          <ul class="shop-box">
            <li class="look-shop">
              
                <% shops.forEach(shop => { %>
                  <a href="/detail/<%= shop.restaurantId %>" class="search">
                  <div class="shop-h row">     

                    <% if (shop.Images && shop.Images.length > 1) { %>
                      <img src="/test/<%= shop.Images[1].imgUrl %>" alt="<%= shop.restaurantName %>" class="col-3 title-img">
                    <% } else if (shop.Images && shop.Images.length > 0) { %>
                      <!-- 만약 첫 번째 이미지만 존재한다면, 첫 번째 이미지를 사용 -->
                      <img src="/test/<%= shop.Images[0].imgUrl %>" alt="<%= shop.restaurantName %>" class="col-3 title-img">
                    <% } else { %>
                      <!-- 이미지가 없을 경우의 대체 이미지 또는 대체 텍스트 -->
                      <img src="/path/to/default/image.png" alt="Default Image" class="col-3 title-img">
                    <% } %>
                    
                      <div class="info col-9">
                        <h3 class="shop-name"><%= shop.restaurantName %></h3>
                        <p class="category"><%= shop.category %></p>
                        <p class="hash"><%= shop.hashTags %></p>
                    
                      <div class="rate d-flex">
                        <p class="score"><span><%= shop.score %></span>점</p>
                        <p class="user-score"><img src="/image/star.png" alt=""><%= shop.userScore %> (<%= shop.reviewCount %>명)</p>
                        <p class="heart"><img src="/image/heart.png" alt=""><span><%= shop.favoriteCount %></span></p>
                      </div>
                    </div>
                    <div class="body">
                      <span>
                        "<%= shop.reviewContent %>"
                      </span>
                    </div>
                  </div>
                <% }); %>
                <div class="shop-b"></div>
              </a>
            </li>
          </ul>
        </div>
      </div>
        
      <div class=" blank col-3"></div>
        <div class="request col-9">
          <div class="inner">
            <h1>찾으시는 식당이 없으신가요?</h1>
            <div class="request-btn"><button><a href="/add">맛집 등록 요청하기</a></button></div>
            <span>보통 당일 등록이 이루어지며, 등록 시 즉시 푸시 알림을 드립니다.</span>
          </div>
        </div>
    </section>
  </main>

  <%- include('footer.ejs') %>



</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>

  // 여러 이미지를 클릭하여 선택할 수 있는 기능
  document.addEventListener("DOMContentLoaded", function() {
    const genderImages = document.querySelectorAll('.gender .click');
    genderImages.forEach(function(image) {
      image.addEventListener('click', function() {
        genderImages.forEach(function(otherImage) {
          otherImage.classList.remove('clicked');
          otherImage.src = "/image/default.png"; // 변경할 이미지의 경로로 수정하세요.
        });
        this.classList.add('clicked');
        this.src = "/image/clicked.png"; // 변경될 이미지의 경로로 수정하세요.
      });
    });


    let question = document.getElementsByClassName('question');

function questionOpen(question,answer){
    if(answer.style.maxHeight){
        answer.style.maxHeight = null;
        question.classList.remove('on');
    } else{
        answer.style.maxHeight = answer.scrollHeight +"px";
        question.classList.add('on');
    }
}

function questionClose(i,item){
    for(let j = 0; j < question.length; j++){
        if(i != j){
        item[j].nextElementSibling.style.maxHeight = null;
        item[j].classList.remove('on');
        }
    }
}

for(let i = 0; i < question.length; i++){
    question[i].addEventListener('click',function(){
        let answer = this.nextElementSibling;

        questionClose(i,question);
        questionOpen(question[i],answer);
    });
}
  });

  const cityList = document.querySelector(".city_list");
  const button = document.querySelector("button.question span");

  cityList.addEventListener("click", function(event) {
    if (event.target.tagName === "LI") {
      button.textContent = event.target.textContent;
    }
  });

  // 평점순으로 정렬하는 함수
  function sortByGrade(shops) {
    return shops.sort((a, b) => b.grade - a.grade);
  }

  // 버튼 요소를 가져와서 클릭 이벤트를 등록합니다.
  const gradeButton = document.querySelector('.grade');

  gradeButton.addEventListener('click', function() {
    console.log('평점순으로 정렬합니다.');
    sortByGrade
    console.log(sortByGrade(shops));
  });

</script>

</html>